//
// Regional Ecal reco based on Level-1 seeds for Egamma, Muons and Taus
//


//
// Getting the list of Ecal FEDs
//   uses EcalListOfFedsProducer module in RecoEgamma/EgammaHLTProducers
//
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalEgammaFEDs.cfi"
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalMuonsFEDs.cfi"
/* taus not yet
include "RecoEgamma/EgammaHLTProducers/data/ecalRegionalTausFEDs.cfi"
*/


//
// Unpacking Digis based on FED lists
//   uses EcalRawToDigiDev module in EventFilter/EcalRawToDigiDev
//
module  ecalRegionalEgammaDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalEgammaDigis.InputLabel="rawDataCollector"
replace ecalRegionalEgammaDigis.DoRegional = true
replace ecalRegionalEgammaDigis.FedLabel = "ecalRegionalEgammaFEDs"
module  ecalRegionalMuonsDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalMuonsDigis.InputLabel="rawDataCollector"
replace ecalRegionalMuonsDigis.DoRegional = true
replace ecalRegionalMuonsDigis.FedLabel = "ecalRegionalMuonsFEDs"
/* taus not yet
module  ecalRegionalTausDigis = ecalEBunpacker from "EventFilter/EcalRawToDigiDev/data/EcalUnpackerData.cfi"
replace ecalRegionalTausDigis.InputLabel="rawDataCollector"
replace ecalRegionalTausDigis.DoRegional = true
replace ecalRegionalTausDigis.FedLabel = "ecalRegionalTausFEDs"
*/


//
// From here on simply cloning ecalLocalRecoSequence.cff
//   with updated InputTags
//
# Calo geometry service model
include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"

module  ecalRegionalEgammaWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalEgammaWeightUncalibRecHit.EBdigiCollection = ecalRegionalEgammaDigis:ebDigis
replace ecalRegionalEgammaWeightUncalibRecHit.EEdigiCollection = ecalRegionalEgammaDigis:eeDigis

module  ecalRegionalEgammaRecHit = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalEgammaRecHit.EBuncalibRecHitCollection = ecalRegionalEgammaWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalEgammaRecHit.EEuncalibRecHitCollection = ecalRegionalEgammaWeightUncalibRecHit:EcalUncalibRecHitsEE

module  ecalRegionalMuonsWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalMuonsWeightUncalibRecHit.EBdigiCollection = ecalRegionalMuonsDigis:ebDigis
replace ecalRegionalMuonsWeightUncalibRecHit.EEdigiCollection = ecalRegionalMuonsDigis:eeDigis

module  ecalRegionalMuonsRecHit = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalMuonsRecHit.EBuncalibRecHitCollection = ecalRegionalMuonsWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalMuonsRecHit.EEuncalibRecHitCollection = ecalRegionalMuonsWeightUncalibRecHit:EcalUncalibRecHitsEE

/* taus not yet
module  ecalRegionalTausWeightUncalibRecHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"
replace ecalRegionalTausWeightUncalibRecHit.EBdigiCollection = ecalRegionalTausDigis
replace ecalRegionalTausWeightUncalibRecHit.EEdigiCollection = ecalRegionalTausDigis

module  ecalRegionalTausRecHit = ecalRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"
replace ecalRegionalTausRecHit.EBuncalibRecHitCollection = ecalRegionalTausWeightUncalibRecHit:EcalUncalibRecHitsEB
replace ecalRegionalTausRecHit.EEuncalibRecHitCollection = ecalRegionalTausWeightUncalibRecHit:EcalUncalibRecHitsEE
*/

//
// Preshower is unchanged!
//
include "RecoLocalCalo/EcalRecProducers/data/ecalPreshowerRecHit.cfi"

//
// sequence definition
//
sequence ecalRegionalEgammaRecoSequence = { 
  ecalRegionalEgammaFEDs , ecalRegionalEgammaDigis ,  
  ecalRegionalEgammaWeightUncalibRecHit , ecalRegionalEgammaRecHit &
  ecalPreshowerRecHit }
sequence ecalRegionalMuonsRecoSequence = { 
  ecalRegionalMuonsFEDs , ecalRegionalMuonsDigis ,
  ecalRegionalMuonsWeightUncalibRecHit , ecalRegionalMuonsRecHit &
  ecalPreshowerRecHit }
/*
sequence ecalRegionalTausRecoSequence = {
  ecalRegionalTausFEDs , ecalRegionalTausDigis ,
  ecalRegionalTausWeightUncalibRecHit , ecalRegionalTausRecHit &
  ecalPreshowerRecHit }
*/
